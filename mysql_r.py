
import pymysql

import time

# 正式
db = pymysql.connect(
    host='rm-m5e1lup6qd395y43wmo.mysql.rds.aliyuncs.com',
    user='wyf',
    password='w30svCNY)d8^FbutOaNi',
    database='rcb_pro',
    charset='utf8'
)


# 测试
# db = pymysql.connect(
#     host='192.168.0.163',
#     user='xdm',
#     password='Xdmxdm@2021',
#     database='rcb_pro',
#     charset='utf8',
#     port=3306
# )


def insert(project):
    '''
    :param project: 项目id
    :return:
    '''
    # db = pymysql.connect(
    #     host='rm-m5e1lup6qd395y43wmo.mysql.rds.aliyuncs.com',
    #     user='wyf',
    #     password='w30svCNY)d8^FbutOaNi',
    #     database='rcb_pro',
    #     charset='utf8'
    # )


    sql = "INSERT INTO `rcb_pro`.`t_attendance_device_service` ( `serial_number`, `project_id`, `start_time`, `end_time`, `create_by`, `create_time` ) (SELECT serial_number AS serial_number,project_id AS project_id,min( attendance_time ) AS start_time,DATE_ADD( min( attendance_time ), INTERVAL 1 YEAR ) AS end_time,'系统生成' AS create_by,now() AS create_time FROM t_labor_attendance_record WHERE project_id = '%s' AND project_id IS NOT NULL AND serial_number IS NOT NULL GROUP BY project_id,serial_number);" %project
    # with db.cursor() as cursor:
    #     cursor.execute(sql)
    #     db.commit()
    print(sql)


if __name__ == '__main__':
    project_lists = [11239,11241,11242,11243,11244,11248,11250,11252,11254,11255,11257,11258,11260,11261,11265,11268,11300,11304,11305,11306,11308,11309,11311,11314,11315,11317,11318,11319,11320,11321,11323,11324,11325,11326,11327,11329,11333,11334,11338,11340,11341,11342,11344,11345,11346,11347,11348,11349,11350,11353,11354,11356,11358,11361,11362,11363,11364,11365,11366,11367,11370,11371,11377,11378,11379,11383,11388,11392,11393,11396,11398,11400,11401,11404,11405,11406,11407,11410,11411,11412,11413,11414,11416,11418,11420,11425,11426,11427,11429,11431,11432,11433,11434,11435,11436,11439,11440,11443,11444,11446,11447,11448,11449,11450,11451,11452,11453,11454,11455,11456,11460,11472,11479,11481,11482,11484,11485,11486,11488,11491,11506,11511,11512,11514,11518,11520,11521,11522,11523,11525,11526,11527,11528,11529,11538,11539,11541,11543,11544,11547,11548,11549,11550,11551,11552,11553,11554,11555,11556,11558,11559,11560,11561,11562,11564,11567,11568,11569,11573,11574,11576,11577,11581,11583,11584,11586,11588,11590,11591,11593,11597,11599,11600,11601,11604,11605,11607,11608,11609,11611,11612,11613,11614,11615,11617,11618,11620,11621,11623,11625,11627,11628,11629,11630,11631,11632,11633,11634,11635,11636,11640,11641,11642,11643,11644,11645,11646,11647,11648,11649,11650,11651,11652,11653,11654,11655,11656,11657,11658,11659,11660,11661,11662,11663,11664,11665,11666,11667,11668,11669,11671,11673,11675,11676,11677,11678,11679,11680,11681,11682,11683,11687,11689,11691,11694,11695,11696,11697,11698,11699,11700,11702,11703,11704,11705,11706,11707,11708,11709,11711,11712,11713,11714,11715,11717,11718,11719,11720,11721,11722,11723,11724,11726,11727,11728,11731,11732,11733,11734,11735,11737,11738,11742,11743,11744,11747,11748,11750,11751,11752,11753,11755,11756,11758,11760,11762,11763,11764,11765,11766,11767,11768,11769,11770,11771,11772,11776,11778,11779,11781,11782,11785,11788,11789,11790,11791,11793,11795,11796,11798,11801,11802,11804,11807,11808,11809,11810,11812,11813,11814,11815,11816,11817,11818,11819,11820,11821,11822,11823,11824,11825,11826,11827,11828,11829,11830,11831,11832,11834,11835,11836,11837,11841,11842,11843,11844,11845,11846,11847,11848,11849,11850,11853,11854,11855,11856,11857,11858,11859,11860,11861,11862,11864,11865,11867,11868,11869,11870,11873,11875,11877,11878,11880,11881,11882,11883,11884,11885,11887,11890,11892,11893,11895,11896,11897,11898,11899,11901,11903,11904,11906,11908,11909,11910,11911,11912,11914,11915,11917,11918,11920,11921,11922,11923,11924,11925,11926,11927,11929,11930,11931,11932,11933,11934,11936,11938,11940,11941,11942,11943,11944,11945,11947,11948,11949,11952,11953,11954,11955,11956,11957,11958,11963,11964,11965,11967,11968,11969,11970,11971,11972,11973,11974,11975,11977,11978,11979,11982,11983,11985,11986,11987,11988,11989,11991,11993,11996,11998,11999,12000,12002,12007,12008,12011,12012,12013,12016,12017,12019,12020,12021,12023,12024,12026,12027,12029,12030,12035,12038,12039,12040,12041,12043,12044,12046,12047,12049,12052,12053,12054,12057,12058,12060,12063,12064,12065,12067,12068,12070,12073,12075,12077,12078,12081,12085,12086,12087,12088,12090,12095,12096,12098,12101,12105,12106,12109,12112,12115,12116,12119,12128,12130,12131,12132,12136,12139,12141,12144,12147,12151,12156,12158,12163,12164,12165,12168,12171,12172,12173,12176,12177,12180,12181,12182,12183,12184,12186,12189,12195,12198,12199,12200,12202,12204,12205,12206,12209,12217,12219,12221,12223,12226,12227,12231,12236,12240,12241,12244,12248,12249,12250,12259,12261,12262,12263,12265,12268,12269,12275,12277,12278,12281,12285,12288,12289,12292,12297,12301,12307,12310,12312,12314,12316,12319,12322,12323,12326,12327,12329,12335,12337,12344]
    for n in project_lists:
        insert(str(n))

